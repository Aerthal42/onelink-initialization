<script type="text/javascript">
    // Функция для парсинга cookie
    function getCookie(name) {
    const value = `; ${document.cookie}`;  
    const parts = value.split(`; ${name}=`);  
    if (parts.length === 2) return parts.pop().split(';').shift();};
  </script>
  
  <script type="text/javascript">
     window.onload = function () {
            
          // Инициализация smart script
            var oneLinkURL = "https://engmntqa.onelink.me/LtRd/";
            var mediaSource = {keys: ["utm_source"]};
            var campaign = {keys: ["utm_campaign"]};
            var custom1 = {paramKey: "af_prt", keys: ["af_prt"]};
            var custom2 = {paramKey: "ad_name", keys: ["utm_ad"]};
            var custom3 = {paramKey: "adset_name", keys: ["utm_adset"]};
            
            // Параметры необходимые для мэтчинга пользователей с facebook. Если не используется источник facebook, тогда afSub1-4 параметры не нужны
            var afSub1 = {keys: ["fbclid"]};
            var afSub2 = {keys:[], defaultValue: getCookie("_fbc")};
            var afSub3 = {keys:[], defaultValue: getCookie("_fbp")};
            var afSub4 = {keys:[], defaultValue: window.navigator.userAgent};
         
            // Параметр необходимый для мэтчинга пользователей с tiktok. Если не используется источник tiktok, тогда afSub5 параметр не нужен
          //var afSub5 = {keys: ["ttclid"]};

            // Генерация Onelink URL
            var result = window.AF_SMART_SCRIPT.generateOneLinkURL({
              oneLinkURL,
              afParameters:{
                mediaSource: mediaSource,
                campaign: campaign,
                // Если не используется площадка facebook для рекламы, тогда afSub1-4 параметры не нужны
                afSub1: afSub1,
                afSub2: afSub2,
                afSub3: afSub3,
                afSub4: afSub4,
             
             // afSub5: afSub5,
                
                afCustom: [
                  custom1,
                  custom2,
                  custom3
                  ]
              }
            });

            // Замена url на всех элементах класса ios-link
            result_url = result.clickURL
            window.alert(result_url);
            var anchors = document.getElementsByClassName("ios-link");
          if (result) {
                for (var i = 0; i < anchors.length; i++) {
                  anchors[i].setAttribute('href', result_url);
                }     
          }
         };
    
  </script>
